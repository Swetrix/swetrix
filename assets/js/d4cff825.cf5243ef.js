"use strict";(globalThis.webpackChunk_swetrix_docs=globalThis.webpackChunk_swetrix_docs||[]).push([[61],{5680(e,t,r){r.d(t,{xA:()=>l,yg:()=>y});var n=r(6540);function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach(function(t){i(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function s(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}var p=n.createContext({}),c=function(e){var t=n.useContext(p),r=t;return e&&(r="function"==typeof e?e(t):a(a({},t),e)),r},l=function(e){var t=c(e.components);return n.createElement(p.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef(function(e,t){var r=e.components,i=e.mdxType,o=e.originalType,p=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),d=c(r),y=i,g=d["".concat(p,".").concat(y)]||d[y]||u[y]||o;return r?n.createElement(g,a(a({ref:t},l),{},{components:r})):n.createElement(g,a({ref:t},l))});function y(e,t){var r=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=r.length,a=new Array(o);a[0]=d;var s={};for(var p in t)hasOwnProperty.call(t,p)&&(s[p]=t[p]);s.originalType=e,s.mdxType="string"==typeof e?e:i,a[1]=s;for(var c=2;c<o;c++)a[c]=r[c];return n.createElement.apply(null,a)}return n.createElement.apply(null,r)}d.displayName="MDXCreateElement"},8681(e,t,r){r.r(t),r.d(t,{assets:()=>p,contentTitle:()=>a,default:()=>u,frontMatter:()=>o,metadata:()=>s,toc:()=>c});var n=r(8168),i=(r(6540),r(5680));const o={title:"How to proxy Swetrix with Next.js",slug:"/adblockers/guides/nextjs"},a=void 0,s={unversionedId:"adblockers/guides/nextjs",id:"adblockers/guides/nextjs",title:"How to proxy Swetrix with Next.js",description:"You can use Next.js to proxy Swetrix analytics traffic via your domain.",source:"@site/docs/adblockers/guides/nextjs.md",sourceDirName:"adblockers/guides",slug:"/adblockers/guides/nextjs",permalink:"/swetrix/adblockers/guides/nextjs",draft:!1,editUrl:"https://github.com/swetrix/docs/edit/main/docs/adblockers/guides/nextjs.md",tags:[],version:"current",frontMatter:{title:"How to proxy Swetrix with Next.js",slug:"/adblockers/guides/nextjs"},sidebar:"docs",previous:{title:"How to proxy Swetrix with Netlify",permalink:"/swetrix/adblockers/guides/netlify"},next:{title:"How to proxy Swetrix with Nginx",permalink:"/swetrix/adblockers/guides/nginx"}},p={},c=[{value:"Setup Next.js rewrites rules",id:"setup-nextjs-rewrites-rules",level:2},{value:"Update Swetrix tracking script configuration",id:"update-swetrix-tracking-script-configuration",level:2}],l={toc:c};function u({components:e,...t}){return(0,i.yg)("wrapper",(0,n.A)({},l,t,{components:e,mdxType:"MDXLayout"}),(0,i.yg)("p",null,"You can use ",(0,i.yg)("a",{parentName:"p",href:"https://nextjs.org/"},"Next.js")," to proxy Swetrix analytics traffic via your domain."),(0,i.yg)("h2",{id:"setup-nextjs-rewrites-rules"},"Setup Next.js rewrites rules"),(0,i.yg)("p",null,"First, you need to add the following rules to the ",(0,i.yg)("inlineCode",{parentName:"p"},"next.config.js")," file. If you don't already have it, you will need to ",(0,i.yg)("a",{parentName:"p",href:"https://nextjs.org/docs/pages/api-reference/next-config-js/rewrites"},"create it")," in your project's root directory first."),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-javascript"},"module.exports = {\n  async rewrites() {\n    return [\n      {\n        source: '/sproxy/:path*',\n        destination: 'https://api.swetrix.com/log/:path*',\n      },\n    ]\n  },\n}\n")),(0,i.yg)("p",null,"Instead of ",(0,i.yg)("inlineCode",{parentName:"p"},"/sproxy")," route, you can use any other name. We recommend using a generic name or even just random letters to avoid being blocked by adblockers in the future."),(0,i.yg)("admonition",{type:"note"},(0,i.yg)("p",{parentName:"admonition"},"Make sure you don't use ",(0,i.yg)("inlineCode",{parentName:"p"},"/log"),", ",(0,i.yg)("inlineCode",{parentName:"p"},"/analytics"),", ",(0,i.yg)("inlineCode",{parentName:"p"},"/analytics.js")," or any similar name, because they're blocked by many adblockers by default."),(0,i.yg)("p",{parentName:"admonition"},"If you are not using the ",(0,i.yg)("a",{parentName:"p",href:"/install-script#install-swetrix-via-npm"},"Swetrix NPM package"),", you will need to add a similar rewrite rule for ",(0,i.yg)("inlineCode",{parentName:"p"},"https://swetrix.org/swetrix.js")," script. Don't forget to also replace it with your proxy URL in the analytics ",(0,i.yg)("inlineCode",{parentName:"p"},"<script>")," tag.")),(0,i.yg)("h2",{id:"update-swetrix-tracking-script-configuration"},"Update Swetrix tracking script configuration"),(0,i.yg)("p",null,"After you set up Next.js redirect rules, you need to update swetrix.js tracking script to send analytics data through it. You can do it by setting the ",(0,i.yg)("inlineCode",{parentName:"p"},"apiURL")," property inside the ",(0,i.yg)("a",{parentName:"p",href:"/swetrix-js-reference#init"},"init() function"),"."),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-javascript"},"swetrix.init('YOUR_PROJECT_ID', {\n  apiURL: 'https://<yourproxydomain>/sproxy',\n})\n")))}u.isMDXComponent=!0}}]);