"use strict";(globalThis.webpackChunk_swetrix_docs=globalThis.webpackChunk_swetrix_docs||[]).push([[8679],{5680(e,t,n){n.d(t,{xA:()=>p,yg:()=>y});var a=n(6540);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach(function(t){r(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function g(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var o=a.createContext({}),d=function(e){var t=a.useContext(o),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=d(e.components);return a.createElement(o.Provider,{value:t},e.children)},s={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef(function(e,t){var n=e.components,r=e.mdxType,l=e.originalType,o=e.parentName,p=g(e,["components","mdxType","originalType","parentName"]),m=d(n),y=r,u=m["".concat(o,".").concat(y)]||m[y]||s[y]||l;return n?a.createElement(u,i(i({ref:t},p),{},{components:n})):a.createElement(u,i({ref:t},p))});function y(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=n.length,i=new Array(l);i[0]=m;var g={};for(var o in t)hasOwnProperty.call(t,o)&&(g[o]=t[o]);g.originalType=e,g.mdxType="string"==typeof e?e:r,i[1]=g;for(var d=2;d<l;d++)i[d]=n[d];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},9972(e,t,n){n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>i,default:()=>s,frontMatter:()=>l,metadata:()=>g,toc:()=>d});var a=n(8168),r=(n(6540),n(5680));const l={title:"Events API reference",slug:"/events-api"},i=void 0,g={unversionedId:"api/events",id:"api/events",title:"Events API reference",description:"With Swetrix you can programmatically record page views or custom events manually. Typically this API is used when doing server-side tracking or in mobile/native applications.",source:"@site/docs/api/events.md",sourceDirName:"api",slug:"/events-api",permalink:"/events-api",draft:!1,editUrl:"https://github.com/swetrix/docs/edit/main/docs/api/events.md",tags:[],version:"current",frontMatter:{title:"Events API reference",slug:"/events-api"},sidebar:"docs",previous:{title:"Statistics API reference",permalink:"/statistics-api"},next:{title:"Admin API reference",permalink:"/admin-api"}},o={},d=[{value:"Concepts",id:"concepts",level:2},{value:"Unique visitors tracking",id:"unique-visitors-tracking",level:3},{value:"Request headers",id:"request-headers",level:3},{value:"User-Agent",id:"user-agent",level:4},{value:"X-Client-IP-Address",id:"x-client-ip-address",level:4},{value:"Content-Type",id:"content-type",level:4},{value:"Pageview event structure",id:"pageview-event-structure",level:3},{value:"Pageview payload",id:"pageview-payload",level:4},{value:"Performance metrics payload",id:"performance-metrics-payload",level:4},{value:"Custom event structure",id:"custom-event-structure",level:3},{value:"Error event structure",id:"error-event-structure",level:3},{value:"Heartbeat event structure",id:"heartbeat-event-structure",level:3},{value:"Endpoints",id:"endpoints",level:2},{value:"POST /log",id:"post-log",level:3},{value:"POST /log/custom",id:"post-logcustom",level:3},{value:"POST /log/hb",id:"post-loghb",level:3},{value:"WebSocket Heartbeat",id:"websocket-heartbeat",level:4},{value:"POST /log/error",id:"post-logerror",level:3},{value:"Status and error codes",id:"status-and-error-codes",level:2},{value:"201 Created",id:"201-created",level:3},{value:"400 Bad Request",id:"400-bad-request",level:3},{value:"402 Payment Required",id:"402-payment-required",level:3},{value:"403 Forbidden",id:"403-forbidden",level:3},{value:"500 Internal Server Error",id:"500-internal-server-error",level:3},{value:"API wrappers",id:"api-wrappers",level:2},{value:"NodeJS",id:"nodejs",level:3},{value:"Contributing",id:"contributing",level:3},{value:"Common request examples",id:"common-request-examples",level:2},{value:"Recording a pageview event using JavaScript fetch API",id:"recording-a-pageview-event-using-javascript-fetch-api",level:3},{value:"Recording a custom event using Go net/http",id:"recording-a-custom-event-using-go-nethttp",level:3},{value:"Recording a heartbeat event using PHP cURL",id:"recording-a-heartbeat-event-using-php-curl",level:3}],p={toc:d};function s({components:e,...t}){return(0,r.yg)("wrapper",(0,a.A)({},p,t,{components:e,mdxType:"MDXLayout"}),(0,r.yg)("p",null,"With Swetrix you can programmatically record page views or custom events manually. Typically this API is used when doing server-side tracking or in mobile/native applications."),(0,r.yg)("p",null,"We already provide several ",(0,r.yg)("a",{parentName:"p",href:"/integrations"},"integrations")," and a ",(0,r.yg)("a",{parentName:"p",href:"/swetrix-js-reference"},"script")," for this, but if for some reason none of these options work for you, you can use the Events API instead."),(0,r.yg)("h2",{id:"concepts"},"Concepts"),(0,r.yg)("h3",{id:"unique-visitors-tracking"},"Unique visitors tracking"),(0,r.yg)("admonition",{type:"caution"},(0,r.yg)("p",{parentName:"admonition"},"For the unique (and live) visitor functionality to work properly, each request must have the ",(0,r.yg)("inlineCode",{parentName:"p"},"User-Agent")," and ",(0,r.yg)("inlineCode",{parentName:"p"},"X-Client-IP-Address")," HTTP headers set. If you don't set these headers, the API will still work, but the unique visitor count will be incorrect.")),(0,r.yg)("p",null,"The API relies on the client's IP address and user agent to create a temporary session (a salted hash that is permanently removed from our database 30 minutes after the last interaction or at 12:00 AM UTC, whichever comes first). We ",(0,r.yg)("strong",{parentName:"p"},"never")," store any visitor identifiable information in our database."),(0,r.yg)("h3",{id:"request-headers"},"Request headers"),(0,r.yg)("h4",{id:"user-agent"},"User-Agent"),(0,r.yg)("p",null,"This header is used to determine the visitor's browser, operating system and device type. It's also used to determine whether or not the visitor is a bot.\nWe also use this header to create a temporary session for the visitor."),(0,r.yg)("h4",{id:"x-client-ip-address"},"X-Client-IP-Address"),(0,r.yg)("p",null,"This header is used to determine the visitor's IP address. You must pass the visitor's IP address using this header, otherwise the API will use the IP address of the server making the request (i.e. your server's IP address), resulting in incorrect unique and live visitor data."),(0,r.yg)("h4",{id:"content-type"},"Content-Type"),(0,r.yg)("p",null,"Must be set to ",(0,r.yg)("inlineCode",{parentName:"p"},"application/json")," for all requests."),(0,r.yg)("h3",{id:"pageview-event-structure"},"Pageview event structure"),(0,r.yg)("h4",{id:"pageview-payload"},"Pageview payload"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:null},"Name"),(0,r.yg)("th",{parentName:"tr",align:null},"Type"),(0,r.yg)("th",{parentName:"tr",align:null},"Required"),(0,r.yg)("th",{parentName:"tr",align:null},"Description"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"pid")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"string")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"true")),(0,r.yg)("td",{parentName:"tr",align:null},"A project ID to record the pageview event for")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"tz")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"string")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"false")),(0,r.yg)("td",{parentName:"tr",align:null},"Visitor's timezone (used as a backup in case IP geolocation fails). I.e. if it's set to ",(0,r.yg)("inlineCode",{parentName:"td"},"Europe/Kiev")," and IP geolocation fails, we will set the country of this entry to ",(0,r.yg)("inlineCode",{parentName:"td"},"Ukraine"),")")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"pg")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"string")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"false")),(0,r.yg)("td",{parentName:"tr",align:null},"A page to record the pageview event for (e.g. ",(0,r.yg)("inlineCode",{parentName:"td"},"/home"),"). All our scripts send the ",(0,r.yg)("inlineCode",{parentName:"td"},"pg")," string with a slash (",(0,r.yg)("inlineCode",{parentName:"td"},"/"),") at the beginning, it's not a requirement but it's best to do the same so the data would be consistent when used together with our official scripts")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"lc")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"string")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"false")),(0,r.yg)("td",{parentName:"tr",align:null},"A locale of the user (e.g. ",(0,r.yg)("inlineCode",{parentName:"td"},"en-US")," or ",(0,r.yg)("inlineCode",{parentName:"td"},"uk-UA"),")")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"ref")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"string")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"false")),(0,r.yg)("td",{parentName:"tr",align:null},"A referrer URL (e.g. ",(0,r.yg)("inlineCode",{parentName:"td"},"https://example.com/"),")")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"so")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"string")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"false")),(0,r.yg)("td",{parentName:"tr",align:null},"A source of the pageview (e.g. ",(0,r.yg)("inlineCode",{parentName:"td"},"ref"),", ",(0,r.yg)("inlineCode",{parentName:"td"},"source")," or ",(0,r.yg)("inlineCode",{parentName:"td"},"utm_source")," GET parameter)")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"me")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"string")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"false")),(0,r.yg)("td",{parentName:"tr",align:null},"A medium of the pageview (e.g. ",(0,r.yg)("inlineCode",{parentName:"td"},"utm_medium")," GET parameter)")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"ca")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"string")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"false")),(0,r.yg)("td",{parentName:"tr",align:null},"A campaign of the pageview (e.g. ",(0,r.yg)("inlineCode",{parentName:"td"},"utm_campaign")," GET parameter)")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"unique")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"boolean")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"false")),(0,r.yg)("td",{parentName:"tr",align:null},"If set to true, only unique visits will be saved")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"perf")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"object")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"false")),(0,r.yg)("td",{parentName:"tr",align:null},"An object with performance metrics related to the page load. See ",(0,r.yg)("a",{parentName:"td",href:"#performance-metrics-payload"},"Performance metrics")," for more details")))),(0,r.yg)("h4",{id:"performance-metrics-payload"},"Performance metrics payload"),(0,r.yg)("p",null,"This section describes the structure of the ",(0,r.yg)("inlineCode",{parentName:"p"},"perf")," object which is used to record performance metrics related to the page loading."),(0,r.yg)("p",null,"All of the values are numbers in milliseconds."),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:null},"Name"),(0,r.yg)("th",{parentName:"tr",align:null},"Type"),(0,r.yg)("th",{parentName:"tr",align:null},"Required"),(0,r.yg)("th",{parentName:"tr",align:null},"Description"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"dns")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"number")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"false")),(0,r.yg)("td",{parentName:"tr",align:null},"DNS Resolution time")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"tls")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"number")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"false")),(0,r.yg)("td",{parentName:"tr",align:null},"TLS handshake time")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"conn")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"number")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"false")),(0,r.yg)("td",{parentName:"tr",align:null},"Connection time")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"response")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"number")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"false")),(0,r.yg)("td",{parentName:"tr",align:null},"Response Time (Download)")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"render")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"number")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"false")),(0,r.yg)("td",{parentName:"tr",align:null},"Browser rendering the HTML page time")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"dom_load")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"number")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"false")),(0,r.yg)("td",{parentName:"tr",align:null},"DOM loading timing")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"page_load")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"number")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"false")),(0,r.yg)("td",{parentName:"tr",align:null},"Page load timing")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"ttfb")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"number")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"false")),(0,r.yg)("td",{parentName:"tr",align:null},"Time to first byte")))),(0,r.yg)("h3",{id:"custom-event-structure"},"Custom event structure"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:null},"Name"),(0,r.yg)("th",{parentName:"tr",align:null},"Type"),(0,r.yg)("th",{parentName:"tr",align:null},"Required"),(0,r.yg)("th",{parentName:"tr",align:null},"Description"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"pid")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"string")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"true")),(0,r.yg)("td",{parentName:"tr",align:null},"A project ID to record the pageview event for")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"ev")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"string")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"true")),(0,r.yg)("td",{parentName:"tr",align:null},"An event identifier you want to track. This has to be a string, which:",(0,r.yg)("br",null),"1. Contains only English letters (a-Z A-Z), numbers (0-9), underscores (","_",") and dots (.).",(0,r.yg)("br",null),"2. Is fewer than 64 characters.",(0,r.yg)("br",null),"3. Starts with an English letter.")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"unique")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"boolean")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"false")),(0,r.yg)("td",{parentName:"tr",align:null},"If set to true, only 1 custom event will be saved per session")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"pg")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"string")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"false")),(0,r.yg)("td",{parentName:"tr",align:null},"A page that user sent data from (e.g. ",(0,r.yg)("inlineCode",{parentName:"td"},"/home"),")")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"lc")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"string")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"false")),(0,r.yg)("td",{parentName:"tr",align:null},"A locale of the user (e.g. ",(0,r.yg)("inlineCode",{parentName:"td"},"en-US")," or ",(0,r.yg)("inlineCode",{parentName:"td"},"uk-UA"),")")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"ref")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"string")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"false")),(0,r.yg)("td",{parentName:"tr",align:null},"A referrer URL (e.g. ",(0,r.yg)("inlineCode",{parentName:"td"},"https://example.com/"),")")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"so")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"string")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"false")),(0,r.yg)("td",{parentName:"tr",align:null},"A source of the pageview (e.g. ",(0,r.yg)("inlineCode",{parentName:"td"},"ref"),", ",(0,r.yg)("inlineCode",{parentName:"td"},"source")," or ",(0,r.yg)("inlineCode",{parentName:"td"},"utm_source")," GET parameter)")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"me")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"string")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"false")),(0,r.yg)("td",{parentName:"tr",align:null},"A medium of the pageview (e.g. ",(0,r.yg)("inlineCode",{parentName:"td"},"utm_medium")," GET parameter)")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"ca")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"string")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"false")),(0,r.yg)("td",{parentName:"tr",align:null},"A campaign of the pageview (e.g. ",(0,r.yg)("inlineCode",{parentName:"td"},"utm_campaign")," GET parameter)")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"meta")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"object")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"false")),(0,r.yg)("td",{parentName:"tr",align:null},"A ",(0,r.yg)("inlineCode",{parentName:"td"},"key")," / ",(0,r.yg)("inlineCode",{parentName:"td"},"value")," pair of custom properties for your event (e.g. if your event is ",(0,r.yg)("inlineCode",{parentName:"td"},"signup"),", you can include ",(0,r.yg)("inlineCode",{parentName:"td"},"meta")," like ",(0,r.yg)("inlineCode",{parentName:"td"},"{ affiliate: 'Yes', currency: 'GBP' }"),"). The values of the object must be a primitive type (string, number, boolean, null) which will be converted to a string, the maximum number of keys allowed is 100 and the total length of the keys and values combined must be less than 2000 characters.")))),(0,r.yg)("h3",{id:"error-event-structure"},"Error event structure"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:null},"Name"),(0,r.yg)("th",{parentName:"tr",align:null},"Type"),(0,r.yg)("th",{parentName:"tr",align:null},"Required"),(0,r.yg)("th",{parentName:"tr",align:null},"Description"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"pid")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"string")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"true")),(0,r.yg)("td",{parentName:"tr",align:null},"A project ID to record the pageview event for")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"name")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"string")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"true")),(0,r.yg)("td",{parentName:"tr",align:null},"Error name (e.g. ",(0,r.yg)("inlineCode",{parentName:"td"},"ParseError"),"); Max length is 200")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"message")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"string")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"false")),(0,r.yg)("td",{parentName:"tr",align:null},"Error message (e.g. ",(0,r.yg)("inlineCode",{parentName:"td"},"Malformed input"),"); Max length is 2000")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"lineno")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"number")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"false")),(0,r.yg)("td",{parentName:"tr",align:null},"Line number")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"colno")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"number")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"false")),(0,r.yg)("td",{parentName:"tr",align:null},"Column number")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"stackTrace")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"string")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"false")),(0,r.yg)("td",{parentName:"tr",align:null},"Stack trace; Max length is 7500")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"filename")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"number")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"false")),(0,r.yg)("td",{parentName:"tr",align:null},"Error message (e.g. ",(0,r.yg)("inlineCode",{parentName:"td"},"https://example.com/assets/convert.js"),"); Max length is 1000")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"tz")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"string")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"false")),(0,r.yg)("td",{parentName:"tr",align:null},"Visitor's timezone (used as a backup in case IP geolocation fails). I.e. if it's set to ",(0,r.yg)("inlineCode",{parentName:"td"},"Europe/Kiev")," and IP geolocation fails, we will set the country of this entry to ",(0,r.yg)("inlineCode",{parentName:"td"},"Ukraine"),")")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"pg")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"string")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"false")),(0,r.yg)("td",{parentName:"tr",align:null},"A page that user sent data from (e.g. ",(0,r.yg)("inlineCode",{parentName:"td"},"/home"),")")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"lc")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"string")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"false")),(0,r.yg)("td",{parentName:"tr",align:null},"A locale of the user (e.g. ",(0,r.yg)("inlineCode",{parentName:"td"},"en-US")," or ",(0,r.yg)("inlineCode",{parentName:"td"},"uk-UA"),")")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"meta")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"object")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"false")),(0,r.yg)("td",{parentName:"tr",align:null},"A ",(0,r.yg)("inlineCode",{parentName:"td"},"key")," / ",(0,r.yg)("inlineCode",{parentName:"td"},"value")," pair of custom properties for your event, for example ",(0,r.yg)("inlineCode",{parentName:"td"},"{ level: 'Critical' }"),". The values of the object must be a primitive type (string, number, boolean, null) which will be converted to a string, the maximum number of keys allowed is 100 and the total length of the keys and values combined must be less than 2000 characters.")))),(0,r.yg)("h3",{id:"heartbeat-event-structure"},"Heartbeat event structure"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:null},"Name"),(0,r.yg)("th",{parentName:"tr",align:null},"Type"),(0,r.yg)("th",{parentName:"tr",align:null},"Required"),(0,r.yg)("th",{parentName:"tr",align:null},"Description"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"pid")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"string")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"true")),(0,r.yg)("td",{parentName:"tr",align:null},"A project ID to record the heartbeat event for")))),(0,r.yg)("h2",{id:"endpoints"},"Endpoints"),(0,r.yg)("h3",{id:"post-log"},"POST /log"),(0,r.yg)("p",null,"This endpoint records pageview events."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-bash",metastring:'title="Request"',title:'"Request"'},'curl -i -X POST https://api.swetrix.com/log \\\n  -H "User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:109.0) Gecko/20100101 Firefox/116.0" \\\n  -H "X-Client-IP-Address: 192.0.2.1" \\\n  -H "Content-Type: application/json" \\\n  -d \'{"pid":"YOUR_PROJECT_ID","lc":"en-US","pg":"/"}\'\n')),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-json",metastring:'title="Response (201 Created)"',title:'"Response',"(201":!0,'Created)"':!0},"{}\n")),(0,r.yg)("h3",{id:"post-logcustom"},"POST /log/custom"),(0,r.yg)("p",null,"This endpoint records custom events."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-bash",metastring:'title="Request"',title:'"Request"'},'curl -i -X POST https://api.swetrix.com/log/custom \\\n  -H "User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:109.0) Gecko/20100101 Firefox/116.0" \\\n  -H "X-Client-IP-Address: 192.0.2.1" \\\n  -H "Content-Type: application/json" \\\n  -d \'{"pid":"YOUR_PROJECT_ID","lc":"en-US","pg":"/"}\'\n')),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-json",metastring:'title="Response (201 Created)"',title:'"Response',"(201":!0,'Created)"':!0},"{}\n")),(0,r.yg)("h3",{id:"post-loghb"},"POST /log/hb"),(0,r.yg)("p",null,"This endpoint is used for heartbeat events. Heartbeat events are used to determine if the user session is still active. This allows you to see the 'Live Visitors' counter in the Dashboard panel.\nIt's recommended to send heartbeat events every 30 seconds. We also extend the session lifetime after receiving a pageview or custom event."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-bash",metastring:'title="Request"',title:'"Request"'},'curl -i -X POST https://api.swetrix.com/log/hb \\\n  -H "User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:109.0) Gecko/20100101 Firefox/116.0" \\\n  -H "X-Client-IP-Address: 192.0.2.1" \\\n  -H "Content-Type: application/json" \\\n  -d \'{"pid":"YOUR_PROJECT_ID"}\'\n')),(0,r.yg)("h4",{id:"websocket-heartbeat"},"WebSocket Heartbeat"),(0,r.yg)("p",null,"For more efficient heartbeat tracking (like long-running sessions, desktop applications, etc.), you can use the WebSocket interface as an alternative to the HTTP endpoint."),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"Connection Details:")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"URL:")," ",(0,r.yg)("inlineCode",{parentName:"li"},"https://api.swetrix.com")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"Namespace:")," ",(0,r.yg)("inlineCode",{parentName:"li"},"/hb")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"Query Parameters:"),(0,r.yg)("ul",{parentName:"li"},(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"pid")," (Required): Your Project ID.")))),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"Events:")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"connected"),": Emitted by the server when the session is successfully established."),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"error"),": Emitted if the connection is rejected (e.g., missing PID, invalid origin, or bot detected).")),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"Example (using socket.io-client):")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-javascript"},"import { io } from 'socket.io-client'\n\nconst socket = io('https://api.swetrix.com/hb', {\n  query: {\n    pid: 'YOUR_PROJECT_ID',\n  },\n  transports: ['websocket'], // Optional: force WebSocket transport\n})\n\nsocket.on('connected', () => {\n  console.log('Heartbeat session established')\n})\n\nsocket.on('error', (err) => {\n  console.error('Heartbeat error:', err.message)\n})\n\n// The server automatically handles the heartbeat interval (every 60s)\n// Keep the connection open as long as the user is active on the page\n")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-json",metastring:'title="Response (201 Created)"',title:'"Response',"(201":!0,'Created)"':!0},"{}\n")),(0,r.yg)("h3",{id:"post-logerror"},"POST /log/error"),(0,r.yg)("p",null,"This endpoint records error events. These error events are later aggregated in the dashboard under the Errors tab."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-bash",metastring:'title="Request"',title:'"Request"'},'curl -i -X POST https://api.swetrix.com/log/error \\\n  -H "User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:109.0) Gecko/20100101 Firefox/116.0" \\\n  -H "X-Client-IP-Address: 192.0.2.1" \\\n  -H "Content-Type: application/json" \\\n  -d \'{"pid":"YOUR_PROJECT_ID","lc":"en-US","pg":"/","name":"ParseError","message":"Malformed input","lineno":12,"colno":510,"filename":"https://example.com/assets/convert.js"}\'\n')),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-json",metastring:'title="Response (201 Created)"',title:'"Response',"(201":!0,'Created)"':!0},"{}\n")),(0,r.yg)("h2",{id:"status-and-error-codes"},"Status and error codes"),(0,r.yg)("h3",{id:"201-created"},"201 Created"),(0,r.yg)("p",null,"The request was successful and the event was recorded."),(0,r.yg)("h3",{id:"400-bad-request"},"400 Bad Request"),(0,r.yg)("p",null,"This error is usually returned when the request body is malformed (for example, the ",(0,r.yg)("inlineCode",{parentName:"p"},"pid")," parameter is missing) or the project is disabled."),(0,r.yg)("h3",{id:"402-payment-required"},"402 Payment Required"),(0,r.yg)("p",null,"This error is usually returned when the project is not active (i.e. the subscription has expired or the quota has been exceeded). Please go to the ",(0,r.yg)("a",{parentName:"p",href:"https://swetrix.com/billing"},"Billing")," page to check the current status and usage of your subscription."),(0,r.yg)("h3",{id:"403-forbidden"},"403 Forbidden"),(0,r.yg)("p",null,"This error is usually returned when the ",(0,r.yg)("inlineCode",{parentName:"p"},"unique")," parameter is set to ",(0,r.yg)("inlineCode",{parentName:"p"},"true")," and the event is not unique, i.e. the pageview event has already been recorded for this session."),(0,r.yg)("h3",{id:"500-internal-server-error"},"500 Internal Server Error"),(0,r.yg)("p",null,"This error is usually returned when the server is unable to process the request due to a temporary problem (for example, the database is unavailable).\nIf you receive this error, please try again later. If the problem persists, please ",(0,r.yg)("a",{parentName:"p",href:"https://swetrix.com/contact"},"contact us"),"."),(0,r.yg)("h2",{id:"api-wrappers"},"API wrappers"),(0,r.yg)("h3",{id:"nodejs"},"NodeJS"),(0,r.yg)("p",null,"Currently we provide an official NodeJS API wrapper for the events API.\nYou can find how to install and use it by opening its ",(0,r.yg)("a",{parentName:"p",href:"https://www.npmjs.com/package/@swetrix/node"},"npm package page"),"."),(0,r.yg)("h3",{id:"contributing"},"Contributing"),(0,r.yg)("p",null,"We welcome any countributions to Swetrix. If you want to create your own API wrapper, feel free to do so. Please ",(0,r.yg)("a",{parentName:"p",href:"https://swetrix.com/contact"},"contact us")," and we will list your library here."),(0,r.yg)("p",null,"Also as an example, feel free to check out the ",(0,r.yg)("a",{parentName:"p",href:"https://github.com/swetrix/swetrix-node"},"source code")," of our NodeJS API wrapper."),(0,r.yg)("h2",{id:"common-request-examples"},"Common request examples"),(0,r.yg)("h3",{id:"recording-a-pageview-event-using-javascript-fetch-api"},"Recording a pageview event using JavaScript fetch API"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-javascript"},"fetch('https://api.swetrix.com/log', {\n  method: 'POST',\n  headers: {\n    'User-Agent': 'FORWARD_CLIENT_USER_AGENT_HERE',\n    'X-Client-IP-Address': 'FORWARD_CLIENT_IP_ADDRESS_HERE',\n    'Content-Type': 'application/json',\n  },\n  body: JSON.stringify({\n    pid: 'YOUR_PROJECT_ID',\n    lc: 'en-US',\n    pg: '/',\n    tz: 'UTC',\n    unique: false,\n  }),\n})\n")),(0,r.yg)("h3",{id:"recording-a-custom-event-using-go-nethttp"},"Recording a custom event using Go net/http"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-go"},'package main\n\nimport (\n  "bytes"\n  "encoding/json"\n  "net/http"\n)\n\nfunc main() {\n  payload, err := json.Marshal(map[string]interface{}{\n    "pid": "YOUR_PROJECT_ID",\n    "ev": "YOUR_EVENT_NAME",\n    "unique": false,\n  })\n  if err != nil {\n    panic(err)\n  }\n\n  req, err := http.NewRequest("POST", "https://api.swetrix.com/log/custom", bytes.NewBuffer(payload))\n  if err != nil {\n    panic(err)\n  }\n\n  req.Header.Set("User-Agent", "FORWARD_CLIENT_USER_AGENT_HERE")\n  req.Header.Set("X-Client-IP-Address", "FORWARD_CLIENT_IP_ADDRESS_HERE")\n  req.Header.Set("Content-Type", "application/json")\n\n  client := &http.Client{}\n  resp, err := client.Do(req)\n  if err != nil {\n    panic(err)\n  }\n  defer resp.Body.Close()\n}\n')),(0,r.yg)("h3",{id:"recording-a-heartbeat-event-using-php-curl"},"Recording a heartbeat event using PHP cURL"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-php"},"$ch = curl_init();\n\ncurl_setopt($ch, CURLOPT_URL, 'https://api.swetrix.com/log/hb');\ncurl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);\ncurl_setopt($ch, CURLOPT_POST, 1);\ncurl_setopt($ch, CURLOPT_POSTFIELDS, json_encode([\n  'pid' => 'YOUR_PROJECT_ID',\n]));\n\n$headers = [\n  'User-Agent: FORWARD_CLIENT_USER_AGENT_HERE',\n  'X-Client-IP-Address: FORWARD_CLIENT_IP_ADDRESS_HERE',\n  'Content-Type: application/json',\n];\n\ncurl_setopt($ch, CURLOPT_HTTPHEADER, $headers);\n\n$result = curl_exec($ch);\ncurl_close($ch);\n")))}s.isMDXComponent=!0}}]);