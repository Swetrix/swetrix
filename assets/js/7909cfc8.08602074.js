"use strict";(globalThis.webpackChunk_swetrix_docs=globalThis.webpackChunk_swetrix_docs||[]).push([[5348],{5680(e,t,n){n.d(t,{xA:()=>p,yg:()=>u});var a=n(6540);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach(function(t){r(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var g=a.createContext({}),d=function(e){var t=a.useContext(g),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},p=function(e){var t=d(e.components);return a.createElement(g.Provider,{value:t},e.children)},y={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef(function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,g=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),m=d(n),u=r,s=m["".concat(g,".").concat(u)]||m[u]||y[u]||i;return n?a.createElement(s,l(l({ref:t},p),{},{components:n})):a.createElement(s,l({ref:t},p))});function u(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,l=new Array(i);l[0]=m;var o={};for(var g in t)hasOwnProperty.call(t,g)&&(o[g]=t[g]);o.originalType=e,o.mdxType="string"==typeof e?e:r,l[1]=o;for(var d=2;d<i;d++)l[d]=n[d];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},7710(e,t,n){n.r(t),n.d(t,{assets:()=>g,contentTitle:()=>l,default:()=>y,frontMatter:()=>i,metadata:()=>o,toc:()=>d});var a=n(8168),r=(n(6540),n(5680));const i={title:"Configuring",slug:"/selfhosting/configuring"},l=void 0,o={unversionedId:"selfhosting/configuring",id:"selfhosting/configuring",title:"Configuring",description:"The easiest way to get started with Swetrix is by using our cloud service. We do all the dirty work for you: hosting, maintenance, backups, worldwide CDN, etc. Using Cloud you still own the data, you can export it or delete it at any time you want. By using Swetrix Cloud you support maintenance and development of the product, which eventually makes it better.",source:"@site/docs/selfhosting/configuring.md",sourceDirName:"selfhosting",slug:"/selfhosting/configuring",permalink:"/selfhosting/configuring",draft:!1,editUrl:"https://github.com/swetrix/docs/edit/main/docs/selfhosting/configuring.md",tags:[],version:"current",frontMatter:{title:"Configuring",slug:"/selfhosting/configuring"},sidebar:"docs",previous:{title:"How to self-host Swetrix",permalink:"/selfhosting/how-to"},next:{title:"How to contribute",permalink:"/contribute"}},g={},d=[{value:"Frontend (swetrix image)",id:"frontend-swetrix-image",level:2},{value:"Backend (swetrix-api image)",id:"backend-swetrix-api-image",level:2},{value:"Basic configuration",id:"basic-configuration",level:3},{value:"Email configuration (SMTP)",id:"email-configuration-smtp",level:3},{value:"OIDC configuration",id:"oidc-configuration",level:3},{value:"Redis",id:"redis",level:2},{value:"Clickhouse",id:"clickhouse",level:2}],p={toc:d};function y({components:e,...t}){return(0,r.yg)("wrapper",(0,a.A)({},p,t,{components:e,mdxType:"MDXLayout"}),(0,r.yg)("admonition",{type:"note"},(0,r.yg)("p",{parentName:"admonition"},"The easiest way to get started with Swetrix is by ",(0,r.yg)("a",{parentName:"p",href:"https://swetrix.com"},"using our cloud service"),". We do all the dirty work for you: hosting, maintenance, backups, worldwide CDN, etc. Using Cloud you still own the data, you can export it or delete it at any time you want. By using Swetrix Cloud you support maintenance and development of the product, which eventually makes it better.")),(0,r.yg)("p",null,"The following environment variables are available for configuration:"),(0,r.yg)("h2",{id:"frontend-swetrix-image"},"Frontend (swetrix image)"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:null},"Variable"),(0,r.yg)("th",{parentName:"tr",align:null},"Default"),(0,r.yg)("th",{parentName:"tr",align:null},"Description"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"API_URL")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"http://localhost:8080/")),(0,r.yg)("td",{parentName:"tr",align:null},"URL of the self-hosted Swetrix API instance. Swetrix frontend will use this variable to connect to the API, so make sure it's correct.")))),(0,r.yg)("admonition",{type:"caution"},(0,r.yg)("p",{parentName:"admonition"},"Swetrix Community Edition is split into two containers: ",(0,r.yg)("inlineCode",{parentName:"p"},"swetrix")," (frontend - the frontend web UI) and ",(0,r.yg)("inlineCode",{parentName:"p"},"swetrix-api")," (backend - the API server, that does auth, data logging, etc.). The ",(0,r.yg)("inlineCode",{parentName:"p"},"API_URL")," variable on the frontend container must point to the ",(0,r.yg)("em",{parentName:"p"},"backend")," container, which by default is ",(0,r.yg)("inlineCode",{parentName:"p"},"http://localhost:8080/"),"."),(0,r.yg)("p",{parentName:"admonition"},"So if you're self-hosting on subdomains, you might run swetrix.mydomain.com proxied to port 80 for the frontend user interface (where you log in), and swetrix-api.mydomain.com proxied to port 8080, and set ",(0,r.yg)("inlineCode",{parentName:"p"},"API_URL=https://swetrix-api.mydomain.com"),"."),(0,r.yg)("p",{parentName:"admonition"},"This is the most common issue users encounter when self-hosting Swetrix Community Edition, so please make sure to set it correctly.")),(0,r.yg)("admonition",{type:"tip"},(0,r.yg)("p",{parentName:"admonition"},"The ",(0,r.yg)("inlineCode",{parentName:"p"},"API_URL")," must be publicly reachable from your users' browsers. Do not set it to a Docker network hostname like ",(0,r.yg)("inlineCode",{parentName:"p"},"http://swetrix-api:8080")," or ",(0,r.yg)("inlineCode",{parentName:"p"},"http://swetrix-api:5005"),". Use a public domain or IP that resolves from the internet, for example ",(0,r.yg)("inlineCode",{parentName:"p"},"https://api.example.com"),".")),(0,r.yg)("h2",{id:"backend-swetrix-api-image"},"Backend (swetrix-api image)"),(0,r.yg)("h3",{id:"basic-configuration"},"Basic configuration"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:null},"Variable"),(0,r.yg)("th",{parentName:"tr",align:null},"Default"),(0,r.yg)("th",{parentName:"tr",align:null},"Description"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"SECRET_KEY_BASE")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("em",{parentName:"td"},"auto-generated by ",(0,r.yg)("inlineCode",{parentName:"em"},"configure.sh"))),(0,r.yg)("td",{parentName:"tr",align:null},"Secret used for auth keys and login sessions. Must be set.")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"CLOUDFLARE_PROXY_ENABLED")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"false")),(0,r.yg)("td",{parentName:"tr",align:null},"If set to ",(0,r.yg)("inlineCode",{parentName:"td"},"true")," - Swetrix will get IP address information from ",(0,r.yg)("inlineCode",{parentName:"td"},"cf-connecting-ip")," header provided by Cloudflare.")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"DISABLE_REGISTRATION")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"true")),(0,r.yg)("td",{parentName:"tr",align:null},"When set to ",(0,r.yg)("inlineCode",{parentName:"td"},"true")," - Swetrix will disable user registration, except for the initial user.")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"IP_GEOLOCATION_DB_PATH")),(0,r.yg)("td",{parentName:"tr",align:null},"``"),(0,r.yg)("td",{parentName:"tr",align:null},"Path to the ",(0,r.yg)("inlineCode",{parentName:"td"},".mmdb")," file for IP geolocation database. By default Swetrix uses IP to City Lite database by DB-IP.")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"IS_PRIMARY_NODE")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"true")),(0,r.yg)("td",{parentName:"tr",align:null},"You should not touch this variable unless you know what you are doing. It's used to spin off multiple API instances in a cluster, where only one of them will be primary. If changed to ",(0,r.yg)("inlineCode",{parentName:"td"},"false"),", things like cron task manager will be disabled for this instance.")))),(0,r.yg)("h3",{id:"email-configuration-smtp"},"Email configuration (SMTP)"),(0,r.yg)("p",null,"Swetrix will send transactional emails for some actions, like password reset or project invitations. You must configure SMTP credentials for this to work correctly."),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:null},"Variable"),(0,r.yg)("th",{parentName:"tr",align:null},"Default"),(0,r.yg)("th",{parentName:"tr",align:null},"Description"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"SMTP_HOST")),(0,r.yg)("td",{parentName:"tr",align:null}),(0,r.yg)("td",{parentName:"tr",align:null},"SMTP host")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"SMTP_PORT")),(0,r.yg)("td",{parentName:"tr",align:null}),(0,r.yg)("td",{parentName:"tr",align:null},"SMTP port")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"SMTP_USER")),(0,r.yg)("td",{parentName:"tr",align:null}),(0,r.yg)("td",{parentName:"tr",align:null},"SMTP user (if your SMTP provider requires authentication)")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"SMTP_PASSWORD")),(0,r.yg)("td",{parentName:"tr",align:null}),(0,r.yg)("td",{parentName:"tr",align:null},"SMTP password (if your SMTP provider requires authentication)")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"FROM_EMAIL")),(0,r.yg)("td",{parentName:"tr",align:null}),(0,r.yg)("td",{parentName:"tr",align:null},"Email address to use for sending emails")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"SMTP_MOCK")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"false")),(0,r.yg)("td",{parentName:"tr",align:null},"If set to ",(0,r.yg)("inlineCode",{parentName:"td"},"true")," - emails will not be sent, but will be logged to the console instead")))),(0,r.yg)("p",null,"If you don't have an SMTP provider, some regular email providers offer this functionality. For example, you can ",(0,r.yg)("a",{parentName:"p",href:"https://support.google.com/mail/answer/185833"},"configure Gmail for app specific passwords")," and use them as SMTP credentials (in this case, the ",(0,r.yg)("inlineCode",{parentName:"p"},"SMTP_HOST")," should be ",(0,r.yg)("inlineCode",{parentName:"p"},"smtp.gmail.com")," with port ",(0,r.yg)("inlineCode",{parentName:"p"},"587"),")."),(0,r.yg)("h3",{id:"oidc-configuration"},"OIDC configuration"),(0,r.yg)("p",null,"Swetrix Community Edition also supports OIDC authentication. To enable it, you need to set the following variables:"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:null},"Variable"),(0,r.yg)("th",{parentName:"tr",align:null},"Default"),(0,r.yg)("th",{parentName:"tr",align:null},"Description"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"OIDC_ENABLED")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"false")),(0,r.yg)("td",{parentName:"tr",align:null},"Must be set to ",(0,r.yg)("inlineCode",{parentName:"td"},"true")," to enable OIDC authentication.")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"OIDC_ONLY_AUTH")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"false")),(0,r.yg)("td",{parentName:"tr",align:null},"If set to ",(0,r.yg)("inlineCode",{parentName:"td"},"true")," - Swetrix will only allow users to authenticate via OIDC (i.e. regular login / registration form will not work).")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"OIDC_DISCOVERY_URL")),(0,r.yg)("td",{parentName:"tr",align:null}),(0,r.yg)("td",{parentName:"tr",align:null},"URL of the OIDC discovery endpoint, for example ",(0,r.yg)("inlineCode",{parentName:"td"},"https://example.com/.well-known/openid-configuration"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"OIDC_CLIENT_ID")),(0,r.yg)("td",{parentName:"tr",align:null}),(0,r.yg)("td",{parentName:"tr",align:null},"OIDC client ID")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"OIDC_CLIENT_SECRET")),(0,r.yg)("td",{parentName:"tr",align:null}),(0,r.yg)("td",{parentName:"tr",align:null},"OIDC client secret")))),(0,r.yg)("h2",{id:"redis"},"Redis"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:null},"Variable"),(0,r.yg)("th",{parentName:"tr",align:null},"Default"),(0,r.yg)("th",{parentName:"tr",align:null},"Description"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"REDIS_PASSWORD")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"password")),(0,r.yg)("td",{parentName:"tr",align:null},"Redis password")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"REDIS_PORT")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"6379")),(0,r.yg)("td",{parentName:"tr",align:null},"Redis port")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"REDIS_USER")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"default")),(0,r.yg)("td",{parentName:"tr",align:null},"Redis user")))),(0,r.yg)("h2",{id:"clickhouse"},"Clickhouse"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:null},"Variable"),(0,r.yg)("th",{parentName:"tr",align:null},"Default"),(0,r.yg)("th",{parentName:"tr",align:null},"Description"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"CLICKHOUSE_DATABASE")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"analytics")),(0,r.yg)("td",{parentName:"tr",align:null},"ClickHouse database")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"CLICKHOUSE_USER")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"default")),(0,r.yg)("td",{parentName:"tr",align:null},"ClickHouse user")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"CLICKHOUSE_PORT")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"8123")),(0,r.yg)("td",{parentName:"tr",align:null},"ClickHouse port")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"CLICKHOUSE_PASSWORD")),(0,r.yg)("td",{parentName:"tr",align:null}),(0,r.yg)("td",{parentName:"tr",align:null},"ClickHouse password")))))}y.isMDXComponent=!0}}]);