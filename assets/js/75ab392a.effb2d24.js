"use strict";(globalThis.webpackChunk_swetrix_docs=globalThis.webpackChunk_swetrix_docs||[]).push([[4433],{5297(e,t,n){n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>a,default:()=>c,frontMatter:()=>i,metadata:()=>l,toc:()=>p});var r=n(8168),o=(n(6540),n(5680));const i={title:"How to self-host Swetrix",slug:"/selfhosting/how-to"},a=void 0,l={unversionedId:"selfhosting/how-to",id:"selfhosting/how-to",title:"How to self-host Swetrix",description:"Swetrix supports self-hosting via Docker. You can run Swetrix on your own server or on a cloud provider of your choice. It's easy to set up and maintain, no need to be a Docker expert.",source:"@site/docs/selfhosting/how-to.md",sourceDirName:"selfhosting",slug:"/selfhosting/how-to",permalink:"/swetrix/selfhosting/how-to",draft:!1,editUrl:"https://github.com/swetrix/docs/edit/main/docs/selfhosting/how-to.md",tags:[],version:"current",frontMatter:{title:"How to self-host Swetrix",slug:"/selfhosting/how-to"},sidebar:"docs",previous:{title:"Testing",permalink:"/swetrix/captcha/testing"},next:{title:"Configuring",permalink:"/swetrix/selfhosting/configuring"}},s={},p=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Installation",id:"installation",level:2},{value:"1. Install the self-hosting repository",id:"1-install-the-self-hosting-repository",level:3},{value:"2. Configure the environment variables",id:"2-configure-the-environment-variables",level:3},{value:"3. Run the container",id:"3-run-the-container",level:3},{value:"Updating",id:"updating",level:2},{value:"Reverse proxy",id:"reverse-proxy",level:2}],u={toc:p};function c({components:e,...t}){return(0,o.yg)("wrapper",(0,r.A)({},u,t,{components:e,mdxType:"MDXLayout"}),(0,o.yg)("p",null,"Swetrix supports self-hosting via Docker. You can run Swetrix on your own server or on a cloud provider of your choice. It's easy to set up and maintain, no need to be a Docker expert."),(0,o.yg)("admonition",{type:"note"},(0,o.yg)("p",{parentName:"admonition"},"The easiest way to get started with Swetrix is by ",(0,o.yg)("a",{parentName:"p",href:"https://swetrix.com"},"using our cloud service"),". We do all the dirty work for you: hosting, maintenance, backups, worldwide CDN, etc. Using Cloud you still own the data, you can export it or delete it at any time you want. By using Swetrix Cloud you support maintenance and development of the product, which eventually makes it better.")),(0,o.yg)("h2",{id:"prerequisites"},"Prerequisites"),(0,o.yg)("p",null,"To self-host Swetrix you need to have the following:"),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},"A server with Docker and Docker Compose installed"),(0,o.yg)("li",{parentName:"ul"},"Support for the x86_64 or arm64 CPU architecture on your server"),(0,o.yg)("li",{parentName:"ul"},"At least 2GB of RAM is recommended for the best performance")),(0,o.yg)("p",null,"Most of the cloud providers offer Docker pre-installed on their servers, but in case it's missing, you can install it manually by following the ",(0,o.yg)("a",{parentName:"p",href:"https://docs.docker.com/get-docker/"},"official Docker installation guide"),".\nWe've tested self-hosting Swetrix using ",(0,o.yg)("a",{parentName:"p",href:"https://hetzner.cloud"},"Hetzner Cloud"),", but any other cloud provider should work just fine."),(0,o.yg)("h2",{id:"installation"},"Installation"),(0,o.yg)("h3",{id:"1-install-the-self-hosting-repository"},"1. Install the self-hosting repository"),(0,o.yg)("p",null,"To self-host Swetrix, download the ",(0,o.yg)("a",{parentName:"p",href:"https://github.com/swetrix/selfhosting"},"self-hosting repository")," from GitHub."),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-bash"},"git clone https://github.com/swetrix/selfhosting\ncd selfhosting\n")),(0,o.yg)("p",null,"That repository contains a ",(0,o.yg)("inlineCode",{parentName:"p"},"compose.yaml")," file with all the necessary configuration to run Swetrix, you'll need to configure it later."),(0,o.yg)("p",null,"The repository also contains various configuration files to ease the setup process (for example, ",(0,o.yg)("inlineCode",{parentName:"p"},"nginx")," or ",(0,o.yg)("inlineCode",{parentName:"p"},"clickhouse")," config files)."),(0,o.yg)("h3",{id:"2-configure-the-environment-variables"},"2. Configure the environment variables"),(0,o.yg)("p",null,"That repository contains a ",(0,o.yg)("inlineCode",{parentName:"p"},"configure.sh")," script that will help you set up the environment variables. It will help you configure and autogenerate some necessary variables."),(0,o.yg)("p",null,"This script will also check if you have Docker and Docker Compose installed, and if you don't, it will try to install them for you."),(0,o.yg)("p",null,"The script will save the environment variables to a ",(0,o.yg)("inlineCode",{parentName:"p"},".env")," file in the repository directory. You can later change them manually if needed."),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-bash"},"./configure.sh\n")),(0,o.yg)("p",null,"You can always manually edit these ",(0,o.yg)("inlineCode",{parentName:"p"},".env")," variables later. Please refer to the ",(0,o.yg)("a",{parentName:"p",href:"/selfhosting/configuring"},"configuration section")," for more information."),(0,o.yg)("h3",{id:"3-run-the-container"},"3. Run the container"),(0,o.yg)("p",null,"Once all the environment variables are set, you can start the containers by running the following command:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-bash"},"docker compose up -d\n")),(0,o.yg)("p",null,"After you run this command, the following containers will be started:"),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("inlineCode",{parentName:"li"},"swetrix-api")," - the main API server running on port ",(0,o.yg)("inlineCode",{parentName:"li"},"8080")," by default"),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("inlineCode",{parentName:"li"},"swetrix-fe")," - the frontend server running on port ",(0,o.yg)("inlineCode",{parentName:"li"},"80")," by default"),(0,o.yg)("li",{parentName:"ul"},"Redis server for caching"),(0,o.yg)("li",{parentName:"ul"},"Clickhouse server for analytics and transactional data")),(0,o.yg)("p",null,"After starting the container you can access the dashboard at ",(0,o.yg)("inlineCode",{parentName:"p"},"http://{host}:80"),"."),(0,o.yg)("h2",{id:"updating"},"Updating"),(0,o.yg)("p",null,"To update Swetrix to the latest version, please refer to the changelog on our ",(0,o.yg)("a",{parentName:"p",href:"https://github.com/swetrix/swetrix"},"GitHub repository"),". Usually, Swetrix releases come with database migrations that you'll need to apply manually. So make sure to backup your database before updating and follow the changelog instructions carefully."),(0,o.yg)("h2",{id:"reverse-proxy"},"Reverse proxy"),(0,o.yg)("p",null,"If you use reverse proxy like Nginx, please set it up to pass the request IP address as the ",(0,o.yg)("inlineCode",{parentName:"p"},"x-real-ip")," header, otherwise it may cause the problems related to API route rate limiting and analytics sessions. If the ",(0,o.yg)("inlineCode",{parentName:"p"},"x-real-ip")," header is undefined, Swetrix will use ",(0,o.yg)("inlineCode",{parentName:"p"},"x-forwarded-for")," or the request IP address as a backup."),(0,o.yg)("p",null,"If you are using Cloudflare as a proxy for your self-hosted Swetrix instance, you can set the ",(0,o.yg)("inlineCode",{parentName:"p"},"CLOUDFLARE_PROXY_ENABLED")," environment variable to ",(0,o.yg)("inlineCode",{parentName:"p"},"true"),". This will force Swetrix to check the ",(0,o.yg)("inlineCode",{parentName:"p"},"cf-connecting-ip")," header for the IP address."),(0,o.yg)("admonition",{type:"caution"},(0,o.yg)("p",{parentName:"admonition"},"If you use Cloudflare Tunnel, avoid nested subdomains such as ",(0,o.yg)("inlineCode",{parentName:"p"},"api.swetrix.example.com")," which may not be supported in some Tunnel setups. Prefer a single-label subdomain like ",(0,o.yg)("inlineCode",{parentName:"p"},"swetrixapi.example.com"),", and set ",(0,o.yg)("inlineCode",{parentName:"p"},"API_URL")," to that public URL.")))}c.isMDXComponent=!0},5680(e,t,n){n.d(t,{xA:()=>u,yg:()=>y});var r=n(6540);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach(function(t){o(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=r.createContext({}),p=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},u=function(e){var t=p(e.components);return r.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},g=r.forwardRef(function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),g=p(n),y=o,d=g["".concat(s,".").concat(y)]||g[y]||c[y]||i;return n?r.createElement(d,a(a({ref:t},u),{},{components:n})):r.createElement(d,a({ref:t},u))});function y(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,a=new Array(i);a[0]=g;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:o,a[1]=l;for(var p=2;p<i;p++)a[p]=n[p];return r.createElement.apply(null,a)}return r.createElement.apply(null,n)}g.displayName="MDXCreateElement"}}]);